var Route=function(e,t){this.regexp=e,this.components=t,this.params=[]};Route.prototype.getRegexp=function(){var e=null;if(null!=(e=/~(.*)?~(.*)?/i.exec(this.regexp))){var t=null;if(e[1]){var o=e[2]?e[2]:"";t=e[1];var r=[];return null!=(r=t.match(/\(\?P<(.*?)>/gi))&&(this.params=r.map(function(e){return e.substring(4,e.length-1)}),t=t.replace(/\(\?P<(.*?)>/gi,"(")),{regexp:new RegExp(t,o)}}return null}return null},Route.prototype.getComponent=function(e){return this.components[e]||""};var Routers=function(e,t){this.collection=e,this.locations=t,this.requestParam={},this.request=!1,this.route=null};Routers.prototype.setUrl=function(e,t,o){return e=e+(t||"")+(o||""),window.history.pushState({url:e},document.title,e),this.match(),this},Routers.prototype.isRequest=function(){return this.request},Routers.prototype.getUrl=function(){return this.locations.pathname+this.locations.search+this.locations.hash},Routers.prototype.getHash=function(){return this.locations.hash},Routers.prototype.getRequestParamName=function(e,t){return t=t||null,this.requestParam[e]?this.requestParam[e]:t},Routers.prototype.getRequestParams=function(){return this.requestParam},Routers.prototype.match=function(){var e=this.getUrl(),t=this.collection.length;this.request=!1,this.route=this.collection[0],this.requestParam={};for(var o=0;t>o;o++){var r=this.collection[o],s=r.getRegexp();if(s&&(!s||s.regexp.test(e))){var n=e.match(s.regexp).slice(1),i=0,a={};n.map(function(e){r.params[i]&&(a[r.params[i]]=e,i++)});var p=decodeURIComponent(location.search.substr(1)).split("&");return p.map(function(e){e=e.split("="),a[e.shift()]=e.join("=")}),this.request=!0,this.route=r,this.requestParam=a,this}}return this},Routers.prototype.getComponent=function(e){return this.route.getComponent(e)},Routers.prototype.getRote=function(){return this.route};var RouteCollection=[];RouteCollection=[new Route("~^/404/?(\\?.*)?$~",{main:ViewError404}),new Route("~^/?(\\?.*)?$~",{main:ViewMain}),new Route("~^/ginny/(?P<user_id>\\d+)/?(\\?.*)?$~",{main:ViewDialog})],function(e,t,o){"undefined"!=typeof module&&module.exports?module.exports=o:"function"==typeof define&&define.amd?define(o):e[t]=o}(this,"ajax",function(){var win=window,doc=document,before,defaultXdrResponseType="json",limit=null,requests=0,request_stack=[],getXHR=function(){return win.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},xhr2=""===getXHR().responseType,ajax=function(method,url,data,options,before){method=method.toUpperCase(),data=data||null,options=options||{};var nativeResponseParsing=!1,crossOrigin,xhr,xdr=!1,timeoutInterval,aborted=!1,retries=0,headers={},mimeTypes={text:"*/*",xml:"text/xml",json:"application/json",post:"application/x-www-form-urlencoded"},accept={text:"*/*",xml:"application/xml; q=1.0, text/xml; q=0.8, */*; q=0.1",json:"application/json; q=1.0, text/*; q=0.8, */*; q=0.1"},contentType="Content-Type",vars="",i,j,serialized,then_stack=[],catch_stack=[],complete_stack=[],response,success,error,func,promises={then:function(e){return options.async?then_stack.push(e):success&&e.call(xhr,response),promises},"catch":function(e){return options.async?catch_stack.push(e):error&&e.call(xhr,response),promises},complete:function(e){return options.async?complete_stack.push(e):e.call(xhr),promises}},promises_limit={then:function(e){return request_stack[request_stack.length-1].then.push(e),promises_limit},"catch":function(e){return request_stack[request_stack.length-1]["catch"].push(e),promises_limit},complete:function(e){return request_stack[request_stack.length-1].complete.push(e),promises_limit}},handleResponse=function(){if(!aborted){var i,req,p,responseType;if(--requests,clearInterval(timeoutInterval),request_stack.length){for(req=request_stack.shift(),p=ajax(req.method,req.url,req.data,req.options,req.before),i=0;func=req.then[i];++i)p.then(func);for(i=0;func=req["catch"][i];++i)p["catch"](func);for(i=0;func=req.complete[i];++i)p.complete(func)}try{if("status"in xhr&&!/^2|1223/.test(xhr.status))throw xhr.status+" ("+xhr.statusText+")";var responseText="responseText",responseXML="responseXML",parseError="parseError";if(nativeResponseParsing&&"response"in xhr&&null!==xhr.response)response=xhr.response;else if("document"==options.responseType){var frame=doc.createElement("iframe");frame.style.display="none",doc.body.appendChild(frame),frame.contentDocument.open(),frame.contentDocument.write(xhr.response),frame.contentDocument.close(),response=frame.contentDocument,doc.body.removeChild(frame)}else{if(responseType=options.responseType,"auto"==responseType)if(xdr)responseType=defaultXdrResponseType;else switch(xhr.getResponseHeader(contentType)){case mimeTypes.json:responseType="json";break;case mimeTypes.xml:responseType="xml";break;default:responseType="text"}switch(responseType){case"json":try{response="JSON"in win?JSON.parse(xhr[responseText]):eval("("+xhr[responseText]+")")}catch(e){throw"Error while parsing JSON body : "+e}break;case"xml":try{win.DOMParser?response=(new DOMParser).parseFromString(xhr[responseText],"text/xml"):(response=new ActiveXObject("Microsoft.XMLDOM"),response.async="false",response.loadXML(xhr[responseText]))}catch(e){response=void 0}if(!response||!response.documentElement||response.getElementsByTagName("parsererror").length)throw"Invalid XML";break;default:response=xhr[responseText]}}if(success=!0,p=response,options.async)for(i=0;func=then_stack[i];++i)p=func.call(xhr,p)}catch(e){if(error=!0,options.async)for(i=0;func=catch_stack[i];++i)func.call(xhr,e,url)}if(options.async)for(i=0;func=complete_stack[i];++i)func.call(xhr)}},buildData=function(e,t){var o,r=[],s=encodeURIComponent;if("object"==typeof e&&null!=e){for(o in e)if(e.hasOwnProperty(o)){var n=buildData(e[o],t?t+"["+o+"]":o);""!==n&&(r=r.concat(n))}}else null!=e&&null!=t&&r.push(s(t)+"="+s(e));return r.join("&")};++requests,options.async="async"in options?!!options.async:!0,options.cache="cache"in options?!!options.cache:"GET"!=method,options.dataType="dataType"in options?options.dataType.toLowerCase():"post",options.responseType="responseType"in options?options.responseType.toLowerCase():"auto",options.user=options.user||"",options.password=options.password||"",options.withCredentials=!!options.withCredentials,options.timeout=options.timeout?parseInt(options.timeout,10):3e3,options.retries=options.retries?parseInt(options.retries,10):3,i=url.match(/\/\/(.+?)\//),crossOrigin=i&&i[1]?i[1]!=location.host:!1,"ArrayBuffer"in win&&data instanceof ArrayBuffer?options.dataType="arraybuffer":"Blob"in win&&data instanceof Blob?options.dataType="blob":"Document"in win&&data instanceof Document?options.dataType="document":"FormData"in win&&data instanceof FormData&&(options.dataType="formdata");var q_data="";if("GET"==method)for(var key in data)""!=q_data&&(q_data+="&"),q_data+=key+"="+data[key];switch(options.dataType){case"json":data=JSON.stringify(data);break;case"post":data=buildData(data)}if(options.headers){var format=function(e,t,o){return t+o.toUpperCase()};for(i in options.headers)headers[i.replace(/(^|-)([^-])/g,format)]=options.headers[i]}if(headers[contentType]||"GET"==method||options.dataType in mimeTypes&&mimeTypes[options.dataType]&&(headers[contentType]=mimeTypes[options.dataType]),headers.Accept||(headers.Accept=options.responseType in accept?accept[options.responseType]:"*/*"),crossOrigin||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest"),"GET"==method&&(vars+=q_data),options.cache||(vars&&(vars+="&"),vars+="__t="+ +new Date),vars&&(url+=(/\?/.test(url)?"&":"?")+vars),limit&&requests==limit)return request_stack.push({method:method,url:url,data:data,options:options,before:before,then:[],"catch":[],complete:[]}),promises_limit;var send=function(){if(xhr=getXHR(),crossOrigin&&("withCredentials"in xhr||!win.XDomainRequest||(xhr=new XDomainRequest,xdr=!0,"GET"!=method&&"POST"!=method&&(method="POST"))),xdr?xhr.open(method,url):(xhr.open(method,url,options.async,options.user,options.password),xhr2&&options.async&&(xhr.withCredentials=options.withCredentials)),!xdr)for(var e in headers)xhr.setRequestHeader(e,headers[e]);if(xhr2&&"document"!=options.responseType)try{xhr.responseType=options.responseType,nativeResponseParsing=xhr.responseType==options.responseType}catch(t){}xhr2||xdr?xhr.onload=handleResponse:xhr.onreadystatechange=function(){4==xhr.readyState&&handleResponse()},"auto"!==options.responseType&&"overrideMimeType"in xhr&&xhr.overrideMimeType(mimeTypes[options.responseType]),before&&before.call(xhr),xdr?setTimeout(function(){xhr.send("GET"!=method?data:null)},0):xhr.send("GET"!=method?data:null)},timeout=function(){timeoutInterval=setTimeout(function(){if(aborted=!0,xhr.abort(),options.retries&&++retries==options.retries){if(aborted=!1,error=!0,response="Timeout ("+url+")",options.async)for(i=0;func=catch_stack[i];++i)func.call(xhr,response)}else aborted=!1,timeout(),send()},options.timeout)};return timeout(),send(),promises},create=function(e){return function(t,o,r){var s=before;return before=null,ajax(e,t,o,r,s)}},obj={before:function(e){return before=e,obj},get:create("GET"),post:create("POST"),put:create("PUT"),"delete":create("DELETE"),xhr2:xhr2,limit:function(e){limit=e},setDefaultXdrResponseType:function(e){defaultXdrResponseType=e.toLowerCase()}};return obj}());var Home=React.createClass({displayName:"Quest",getInitialState:function(){return{load:!0}},render:function(){var e=this.props.router.getComponent("header"),t=this.props.router.getComponent("left"),o=this.props.router.getComponent("main"),r=this.props.router.getComponent("right"),s=this.props.router.getComponent("footer"),n={router:this.props.router,state_root:this.state};return React.createElement("div",{id:"content"},e?React.createElement(e,n):React.createElement(viewHeader,n),t?React.createElement(t,n):null,r?React.createElement(r,n):null,o?React.createElement(o,n):null,s?React.createElement(s,n):null)}});window.addEventListener("load",function(){var e=new Routers(RouteCollection,window.document.location);React.render(React.createElement(Home,{router:e.match()}),document.getElementById("wrapper"))});